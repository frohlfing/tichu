/* css/game-table-view.css */

#game-table-screen {
    background-image: url('../images/table.png');
    background-size: 1080px 1920px; /* Exakte Größe des Hintergrundbildes anpassen */
    background-position: center center;
    background-repeat: no-repeat;
    color: #fff;
    font-size: 24px; /* Basisschriftgröße für den Spieltisch (anpassen!) */
    position: absolute;
    width: 100%;
    height: 100%;
}

/* --- Top Bar --- */
.top-bar {
    position: absolute;
    top: 0px;
    left: 0px;
    width: 1080px;
    height: 140px;
    background-color: rgba(0,0,0,0.65);
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0 30px; /* Godot: Seitenabstand */
    z-index: 10;
}
.top-bar #score-display {
    font-weight: bold;
    font-size: 46px;
    line-height: 1;
    text-align: center;
    flex-grow: 1;
    color: #f0f0f0;
}
.top-bar .game-button { /* Styling für Beenden, Optionen Buttons */
    padding: 10px 25px;
    font-family: 'Architect s Daughter', sans-serif;
    font-size: 32px;
    border-radius: 8px;
    background-color: #5a6670; /* Etwas dunkleres Grau */
    color: white;
    border: none;
    cursor: pointer;
    transition: background-color 0.2s;
    min-height: 80px;
}
.top-bar .game-button:hover:not(:disabled) { background-color: #717d86; }
.top-bar .game-button:disabled { background-color: #424242; color: #888; cursor: not-allowed; }


/* --- Table Area (als Hauptcontainer, positioniert Elemente absolut darin) --- */
.table-area {
    position: absolute;
    top: 140px;     /* Höhe der Top-Bar */
    bottom: 140px; /* Höhe der Bottom-Controls */
    left: 0;
    right: 0;
}

/* --- Spielerbereiche (jetzt absolut positioniert) --- */
.player-area {
    position: absolute;
    display: flex;
    flex-direction: column;
    align-items: center;
}

/* Spieler Unten (Ich) - Relativer Index 0 */
.player-bottom {
    bottom: 28px; /* Abstand von .table-area unten */
    left: 50%;
    transform: translateX(-50%);
    width: 1040px; /* Breite für Hand + Info */
    height: 400px;
    justify-content: flex-end; /* Info oben, Hand unten */
}
.player-bottom .player-info { margin-bottom: 50px; }
.player-bottom .hand { height: 180px; /* Höhe für 14 gefächerte Karten */ }
.player-bottom .tichu-indicator {
    position: absolute;
    top: 0;
    right: 80px;
}

/* Spieler Oben (Partner) - Relativer Index 2 */
.player-top {
    top: 15px; /* Abstand von .table-area oben */
    left: 50%;
    transform: translateX(-50%);
    width: 700px; /* Partnerhand oft schmaler dargestellt */
    justify-content: flex-start;
}
.player-top .player-info { margin-top: 10px; order: 1; }
.player-top .hand { height: 120px; order: 0; }

/* Spieler Links - Relativer Index 3 */
.player-left {
    left: 20px; /* Abstand von .table-area links */
    top: 50%;
    transform: translateY(-50%);
    width: 120px; /* Breite wird zur "Höhe" der rotierten Hand */
    height: 700px; /* Höhe des Bereichs für die rotierte Hand */
    justify-content: center;
}
.player-left .player-info { transform: rotate(90deg) translateY(-100%); transform-origin: bottom left; margin-bottom: 10px; /* Abstand zur Hand */ }

/* Spieler Rechts - Relativer Index 1 */
.player-right {
    right: 20px; /* Abstand von .table-area rechts */
    top: 50%;
    transform: translateY(-50%);
    width: 120px;
    height: 700px;
    justify-content: center;
}
.player-right .player-info { transform: rotate(-90deg) translateY(-100%); transform-origin: bottom right; margin-bottom: 10px; }


.player-info {
    font-size: 46px;
    padding: 5px 12px;
    border-radius: 5px;
    white-space: nowrap;
    z-index: 2;
    display: flex; /* Für interne Anordnung von Name, Count, Icons */
    align-items: center;
    gap: 8px;
}

.tichu-indicator:not(.hidden) {
    /*animation: pulse 1.5s infinite;*/
    width: 170px;
    height: 170px;
}

@keyframes pulse {
    0% { transform: scale(1); opacity: 0.7; }
    50% { transform: scale(1.15); opacity: 1; }
    100% { transform: scale(1); opacity: 0.7; }
}
.turn-indicator:not(.hidden) {
    box-shadow: 0 0 8px 3px gold;
    border-radius: 50%;
    background-color: rgba(255, 215, 0, 0.4);
    height: 100px;
}
#bomb-icon {
    cursor: pointer;
    width: 170px;
    height: 170px;
    position: absolute;
    top: 0;
    left: 80px;
}


/* --- Hände der Spieler --- */
.hand {
    display: flex;
    justify-content: center; /* Standard für eigene und Partnerhand */
    position: relative;
    width: 100%;
}
.own-hand .card {
    width: 120px;
    height: 180px;
    border-radius: 6px;
    margin: 0 -95px; /* Überlappung für 14 Karten */
    cursor: pointer;
    transition: transform 0.15s ease-out;
    border: 1px solid #444;
    box-shadow: 2px 2px 4px rgba(0,0,0,0.4);
    background-size: 100% 100%;
    background-repeat: no-repeat;
    image-rendering: crisp-edges;
}
.own-hand .card.selected {
    transform: translateY(-30px);
}
.own-hand.disabled-hand .card {
    cursor: default;
}

.opponent-hand .card-back {
    width: 66px; /* Kleinere Karten für Gegner */
    height: 92px;
    border-radius: 4px;
    background-image: url('../images/cards/back.png');
    background-size: contain;
    border: 1px solid #333;
    box-shadow: 1px 1px 2px rgba(0,0,0,0.3);
}
.player-top .opponent-hand { align-items: flex-start; }
.player-top .opponent-hand .card-back {
    margin: 0 -45px; /* Starke Überlappung für 14 Karten */
    transform: rotate(180deg);
}
.player-left .hand, .player-right .hand {
    flex-direction: column;
    align-items: center; /* Zentriert den Stapel horizontal */
    height: 100%; /* Volle Höhe des Spielerbereichs */
    width: auto;  /* Breite durch Karten bestimmt */
}
.player-left .opponent-hand .card-back {
    margin-bottom: -75px; /* Starke vertikale Überlappung (ca. 80% der Kartenhöhe) */
    transform: rotate(90deg);
}
.player-right .opponent-hand .card-back {
    margin-bottom: -75px;
    transform: rotate(-90deg);
}
.opponent-hand.revealed .card-back { display: none; }
.opponent-hand.revealed .card-face {
    width: 66px; height: 92px; border-radius: 4px;
    background-size: contain; border: 1px solid #333; box-shadow: 1px 1px 2px rgba(0,0,0,0.3);
}
.player-left .opponent-hand.revealed .card-face { margin-bottom: -75px; transform: rotate(90deg); }
.player-right .opponent-hand.revealed .card-face { margin-bottom: -75px; transform: rotate(-90deg); }


/* --- Center Table & Played Cards --- */
.center-table {
    position: absolute;
    /* Godot: Position und Größe des mittleren Bereichs */
    left: 220px;  /* (1080 - 640) / 2 */
    top: 250px;   /* Schätzung */
    width: 640px; /* Breite für gespielte Karten */
    height: 900px;/* Höhe für gespielte Karten + Wunsch */
    display: grid;
    grid-template-columns: 1fr 1fr;
    grid-template-rows: 1fr 1fr; /* Für die 4 Stapel */
    place-items: center; /* Zentriert die .played-cards-pile in den Grid-Zellen */
    gap: 10px;
}
.played-cards-pile {
    display: flex;
    flex-wrap: nowrap;
    justify-content: center;
    align-items: center;
    width: 100%; /* Füllt die Grid-Zelle */
    height: 100%;
    transform-origin: center center;
    /* min-height für Karten */
}
#played-cards-pile-player-0 { grid-row: 2; grid-column: 1 / span 2; align-items: flex-start; padding-top: 20px; }
#played-cards-pile-player-1 { grid-row: 1 / span 2; grid-column: 2; transform: rotate(-90deg) translateX(-5%);}
#played-cards-pile-player-2 { grid-row: 1; grid-column: 1 / span 2; align-items: flex-end; padding-bottom: 20px;}
#played-cards-pile-player-3 { grid-row: 1 / span 2; grid-column: 1; transform: rotate(90deg) translateX(5%);}

.played-cards-pile .card {
    width: 80px; /* Größe gespielter Karten */
    height: 112px;
    margin: 0 2px;
    border-radius: 5px;
    border: 1px solid #444;
    background-size: 100% 100%;
}
.played-cards-pile .played-pass,
.played-cards-pile .played-bomb-text {
    font-size: 30px; font-weight: bold; padding: 10px;
    background-color: rgba(0,0,0,0.6); border-radius: 5px;
}


/* --- Indikatoren in der Mitte --- */
#wish-indicator {
    position: absolute;
    left: 50%; top: 50%; transform: translate(-50%, -50%); /* Zentriert im .center-table */
    width: 90px; height: 90px;
    background-image: url('../images/wish-indicator.png');
    background-size: contain;
    background-repeat: no-repeat;
    border-radius: 50%;
    box-shadow: 0 0 12px 3px gold, 0 0 6px gold inset;
    display: flex; justify-content: center; align-items: center; text-align: center;
    z-index: 5; /* Über gespielten Karten */
}
.wish-value-text {
    font-size: 40px; font-weight: bold; color: #111;
    text-shadow: 0 0 3px #fff;
}


/* --- Schupf-Zonen --- */
.schupf-zones {
    position: absolute;
    bottom: 200px; /* Über eigener Hand: table-area bottom (110px) + hand height (ca. 160px) + margin (10px) -> ca. 280px von unten. */
                   /* Oder vom unteren Rand des #game-wrapper: 110 (bottom-controls) + 15 (player-area-bottom) + 160 (hand) + 10 (margin) + 10 (pos) = ~300px */
    left: 50%; transform: translateX(-50%);
    display: flex;
    gap: 25px;
    padding: 10px 15px;
    background-color: rgba(0,0,0,0.35);
    border-radius: 8px;
    z-index: 15; /* Über den Händen */
}
.schupf-zone {
    width: 90px; height: 125px; /* Etwas größer als Karten */
    border: 2px dashed #bbb;
    border-radius: 6px;
    display: flex; flex-direction: column; justify-content: center; align-items: center;
    color: #ddd; font-size: 22px; cursor: pointer;
}
.schupf-zone .card { width: 82px; height: 115px; border: none; box-shadow: none; pointer-events: none; }
.schupf-zone:empty::before { content: attr(data-target-player-relative); font-weight: bold; }


/* --- Bottom Controls --- */
.bottom-controls {
    position: absolute;
    bottom: 0px;
    left: 0px;
    width: 1080px;
    height: 140px;
    background-color: rgba(0,0,0,0.7);
    display: flex;
    justify-content: space-around;
    align-items: center;
    padding: 0 40px; /* Mehr seitliches Padding für Button-Abstand */
    font-size: 32px;
}
.bottom-controls .game-button {
    flex-grow: 1; /* Buttons teilen sich den Platz */
    margin: 0 15px; /* Abstand zwischen Buttons */
    max-width: 280px; /* Maximale Breite pro Button */
    padding: 12px 0; /* Vertikales Padding, horizontales durch flex */
    min-height: 80px;
    font-family: 'Architect s Daughter', sans-serif;
    font-size: 32px; /* Erbt von .bottom-controls */
    border-radius: 8px;
    background-color: #5a6670;
    color: white;
    border: none;
    cursor: pointer;
    transition: background-color 0.2s;
}
.bottom-controls .game-button:hover:not(:disabled) { background-color: #717d86; }
.bottom-controls .game-button:disabled { background-color: #424242; color: #888; cursor: not-allowed; }


/* --- Visuelle Effekte & Animationen --- */
.own-hand .card.playing,
.played-cards-pile .card.just-played {
    transition: transform 0.4s ease-out, opacity 0.4s ease-out;
    /* transform: scale(1.05); Beim Spielen leicht vergrößern/anheben */
}
.played-cards-pile .card.highlight-trick {
    transform: scale(1.1) translateY(-5px); /* Pixelwerte für feste Kartengrößen */
    box-shadow: 0 0 12px 3px gold, 0 0 4px gold inset;
    border: 1px solid gold;
    z-index: 5; /* Über anderen Karten im Stapel */
}
.card.flying {
    position: fixed; /* Wichtig: fixed für Animation relativ zum Viewport, nicht zum skalierten Wrapper */
    transition: all 0.6s cubic-bezier(0.25, 0.75, 0.5, 1);
    z-index: 1000; /* Über fast allem */
    /* Die Start left/top Werte müssen von JS gesetzt werden, basierend auf der *Viewport*-Position der Karte */
    /* Und die Ziel left/top Werte ebenfalls relativ zum *Viewport* */
}
.own-hand .card.schupf-candidate {
    opacity: 0.6;
    border: 2px dashed gold !important;
    transform: translateY(-10px); /* Leicht anheben */
}
.own-hand .card.in-schupf-zone { display: none !important; }

.bomb-effect-text {
    position: absolute; /* Innerhalb von .center-table oder .table-area */
    top: 50%; left: 50%;
    font-size: 100px; /* Großer Text */
    color: red;
    font-weight: bold;
    text-shadow: 3px 3px 0 #000, -3px -3px 0 #000, 3px -3px 0 #000, -3px 3px 0 #000;
    opacity: 1;
    z-index: 200;
    animation: bombExplode 0.8s ease-out forwards;
    pointer-events: none;
    transform: translate(-50%, -50%) scale(1); /* Start für Animation */
}
@keyframes bombExplode {
    0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0.5; }
    70% { transform: translate(-50%, -50%) scale(1.5); opacity: 1; }
    100% { transform: translate(-50%, -50%) scale(1.2); opacity: 0; }
}