<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Tichu Online</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="images/icon.png" type="image/png">
</head>
<body>
    <!-- Ladeanzeige -->
    <div id="loading-screen" class="view">
        <img src="images/logo.png" alt="Logo" class="logo">
        <p>Verbinde...</p>
        <img src="images/spinner.png" alt="Laden..." class="spinner">
    </div>

    <!-- Login-Bildschirm -->
    <div id="login-screen" class="view">
        <div class="login-background"></div>
        <h1>Tichu</h1>
        <form id="login-form">
            <input type="text" id="player-name" title="" placeholder="Dein Name" required/>
            <input type="text" id="table-name" title="" placeholder="Tischname" required/>
            <button type="submit">Betreten</button>
        </form>
    </div>

    <!-- Lobby-Bildschirm -->
    <div id="lobby-screen" class="view">
        <h2>Lobby: <span id="lobby-table-name"></span></h2>
        <div id="player-list-container">
            <p>Spieler am Tisch:</p>
            <ul id="lobby-player-list"></ul>
        </div>
        <div id="team-assignment-container" class="hidden">
            <p>Spieler anordnen (Host):</p>
        </div>
        <div class="lobby-actions-bottom">
            <button id="start-game-button" class="hidden">Spiel starten</button>
            <button id="leave-lobby-button">Beenden</button>
        </div>
    </div>

    <!-- Spieltisch-Bildschirm -->
    <div id="game-table-screen" class="view">
        <div class="top-bar">
            <button id="end-game-button" class="game-button">Beenden</button>
            <div id="score-display">Team Wir: 0000 | Team Die: 0000</div>
            <button id="options-button" class="game-button">Optionen</button>
        </div>
        <div class="table-area">
            <div class="player-area player-top" id="player-area-2">
                <div class="player-info"><span class="player-name">Partner</span><span class="card-count">0</span><img src="images/tichu-indicator.png" class="tichu-indicator hidden" alt="T"><img src="images/turn-indicator.png" class="turn-indicator hidden" alt="*"></div>
                <div class="hand opponent-hand" id="player-2-hand"></div>
            </div>
            <div class="player-area player-left" id="player-area-3">
                 <div class="player-info"><span class="player-name">Gegner L.</span><span class="card-count">0</span><img src="images/tichu-indicator.png" class="tichu-indicator hidden" alt="T"><img src="images/turn-indicator.png" class="turn-indicator hidden" alt="*"></div>
                <div class="hand opponent-hand" id="player-3-hand"></div>
            </div>
            <div class="player-area player-right" id="player-area-1">
                <div class="player-info"><span class="player-name">Gegner R.</span><span class="card-count">0</span><img src="images/tichu-indicator.png" class="tichu-indicator hidden" alt="T"><img src="images/turn-indicator.png" class="turn-indicator hidden" alt="*"></div>
                <div class="hand opponent-hand" id="player-1-hand"></div>
            </div>
            <div class="center-table">
                <div id="played-cards-pile-player-0" class="played-cards-pile"></div>
                <div id="played-cards-pile-player-1" class="played-cards-pile"></div>
                <div id="played-cards-pile-player-2" class="played-cards-pile"></div>
                <div id="played-cards-pile-player-3" class="played-cards-pile"></div>
                <img src="images/wish-indicator.png" id="wish-indicator" class="hidden" alt="Wunsch">
            </div>
            <div class="schupf-zones hidden">
                <div class="schupf-zone" id="schupf-zone-opponent-right" data-target-player-relative="1">R</div>
                <div class="schupf-zone" id="schupf-zone-partner" data-target-player-relative="2">P</div>
                <div class="schupf-zone" id="schupf-zone-opponent-left" data-target-player-relative="3">L</div>
            </div>
            <div class="player-area player-bottom" id="player-area-0">
                <div class="player-info"><span class="player-name">Ich</span><span class="card-count">0</span><img src="images/tichu-indicator.png" class="tichu-indicator hidden" alt="T"><img src="images/turn-indicator.png" class="turn-indicator hidden" alt="*"><img src="images/bomb.png" id="bomb-icon" class="hidden" alt="B"></div>
                <div class="hand own-hand" id="player-0-hand"></div>
            </div>
        </div>
        <div class="bottom-controls">
            <button id="pass-button" class="game-button" disabled>Passen</button>
            <button id="tichu-button" class="game-button" disabled>Tichu</button>
            <button id="play-cards-button" class="game-button" disabled>Spielen</button>
        </div>

        <!-- TEST BUTTONS (werden später entfernt) -->
        <div id="test-controls-container" style="position: fixed; bottom: 70px; left: 10px; background: rgba(0,0,0,0.7); padding: 10px; border-radius: 5px; z-index: 1001; display: flex; flex-direction: column; gap: 5px; max-height: calc(100vh - 150px); overflow-y: auto;">
            <h4>Visuelle Tests</h4>
            <button data-test="deal-own-cards">1. Eigene Karten austeilen</button>
            <button data-test="select-cards">1.1 Karten selektieren (danach manuell klicken)</button>
            <button data-test="play-selected-cards">2. Selektierte ausspielen</button>
            <input type="number" id="test-player-index" value="1" min="1" max="3" style="width: 50px;" title="Mitspieler (1=R, 2=P, 3=L)">
            <button data-test="opponent-plays-cards">3. Mitspieler legt ab</button>
            <button data-test="highlight-trick">4. Stich überstechen (Highlight)</button>
            <button data-test="take-trick-self">5.1 Stich selbst kassieren</button>
            <button data-test="take-trick-opponent">5.2 Stich zu Mitspieler</button>
            <button data-test="show-schupf-zones">6.1 Eigene Schupf-Zonen zeigen</button>
            <button data-test="give-own-schupf-card">6.2 Eigene Schupfkarte abgeben (Zone Rechts)</button>
            <button data-test="opponent-schupf-cards">7. Schupfk. Gegner/Partner</button>
            <button data-test="animate-schupf-exchange">8. Schupfk. vertauschen (Animation)</button>
            <button data-test="take-schupf-cards">10. Schupfk. aufnehmen</button>
            <input type="text" id="test-score" value="100:50" title="Punkte (Wir:Die)">
            <button data-test="update-score">11. Score ändern</button>
            <input type="text" id="test-player-name" value="NeuerName" title="Neuer Name für Spieler Rechts">
            <button data-test="update-player-name">12. Mitspielername ändern</button>
            <button data-test="toggle-dragon-dialog">13. Drachen-Dialog</button>
            <button data-test="toggle-wish-dialog">14.1 Wunsch-Dialog</button>
            <button data-test="show-wish-indicator">14.2 Wunsch-Indikator zeigen (7)</button>
            <button data-test="hide-wish-indicator">15. Wunsch-Indikator ausblenden</button>
            <button data-test="toggle-bomb-icon">16. Bomben-Icon</button>
            <button data-test="throw-bomb-effect">17. Bombe werfen (Effekt)</button>
            <button data-test="toggle-tichu-player1">18. Tichu-Indikator (Spieler Rechts)</button>
            <button data-test="next-turn-indicator">19. Turn-Indikator wandern</button>
            <button data-test="reveal-opponent-cards">20. Karten Gegner zeigen</button>
            <button data-test="toggle-round-end-dialog">21. Rundenende-Dialog</button>
            <button data-test="toggle-game-end-dialog">22. Spielende-Dialog</button>
            <button data-test="toggle-leave-dialog">23. Verlassen-Dialog</button>
            <button data-test="show-error-toast">24. Fehler anzeigen</button>
        </div>
    </div>

    <!-- Dialoge (modal) -->
    <div id="wish-dialog" class="dialog hidden">
        <h3>Wähle einen Kartenwert</h3>
        <div id="wish-options"></div>
        <button id="confirm-wish-button">Wünschen</button>
    </div>
    <div id="dragon-dialog" class="dialog hidden">
        <h3>Wem den Drachenstich geben?</h3>
        <button id="dragon-to-left-button">Gegner Links</button>
        <button id="dragon-to-right-button">Gegner Rechts</button>
    </div>
    <div id="round-end-dialog" class="dialog hidden">
        <h3>Runde beendet</h3>
        <p id="round-result-text">Ergebnis: 000 : 000</p>
        <button id="ok-round-end-button">Ok</button>
    </div>
    <div id="game-end-dialog" class="dialog hidden">
        <h3>Partie beendet</h3>
        <p id="game-result-text">Ergebnis: 0000 : 0000</p>
        <button id="ok-game-end-button">Zur Lobby</button>
    </div>
    <div id="leave-confirm-dialog" class="dialog hidden">
        <h3>Wirklich beenden?</h3>
        <button id="confirm-leave-button">Ja</button>
        <button id="cancel-leave-button">Nein</button>
    </div>
    <div id="error-toast" class="toast hidden">
        <p id="error-toast-message"></p>
    </div>

    <!-- Module (Reihenfolge ist wichtig!) -->
    <script src="js/constants.js"></script>
    <script src="js/helpers.js"></script>
    <script src="js/event-bus.js"></script>
    <script src="js/sound-manager.js"></script>
    <script src="js/state.js"></script>
    <script src="js/user.js"></script>
    <script src="js/network.js"></script>
    <script src="js/card-handler.js"></script>
    <script src="js/dialogs.js"></script>
    <script src="js/views/loading-view.js"></script>
    <script src="js/views/login-view.js"></script>
    <script src="js/views/lobby-view.js"></script>
    <script src="js/views/game-table-view.js"></script>
    <script src="js/view-manager.js"></script>
    <script src="js/app-controller.js"></script>
    <script src="js/main.js"></script>
</body>
</html>